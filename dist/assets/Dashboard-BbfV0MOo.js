import{j as e,F as c,a as b,b as P,g as a,c as n,d as r,q as m,w as f,o as y,l as w}from"./index-B3Xy1xuM.js";import{r as l,L as d}from"./vendor-Cc1FqKl_.js";import"./ui-LFaGVoCt.js";const $=()=>{const[o,D]=l.useState({totalEvents:0,upcomingEvents:0,totalDonations:0,totalUsers:0}),[x,E]=l.useState([]),[h,S]=l.useState([]),[L,g]=l.useState(!0),[j,U]=l.useState(null);l.useEffect(()=>{(async()=>{try{const i=new Date;i.setHours(0,0,0,0);const[F,R,A,V,z,C]=await Promise.all([a(n(r,"events")),a(m(n(r,"events"),f("date",">=",i))),a(m(n(r,"events"),f("date",">=",i),y("date","asc"),w(5))),a(n(r,"donations")),a(m(n(r,"donations"),y("timestamp","desc"),w(5))),a(n(r,"users"))]),T=F.size,k=R.size,v=[];A.forEach(t=>{v.push({id:t.id,...t.data(),date:t.data().date.toDate()})});let p=0;V.forEach(t=>{p+=Number(t.data().amount)});const N=[];z.forEach(t=>{N.push({id:t.id,...t.data(),timestamp:t.data().timestamp?.toDate()||new Date})});const q=C.size;D({totalEvents:T,upcomingEvents:k,totalDonations:p,totalUsers:q}),S(v),E(N),g(!1)}catch(i){console.error("Error fetching dashboard data:",i),U("Failed to load dashboard data. Please try again."),g(!1)}})()},[]);const u=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsx("div",{className:"py-10 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Admin Dashboard"}),L?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-orange-500"})}):j?e.jsx("div",{className:"flex justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-xl mb-4",children:"⚠️"}),e.jsx("p",{className:"text-red-600 mb-4",children:j}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600",children:"Retry"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-orange-100 text-orange-500 mr-4",children:e.jsx(c,{className:"text-2xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Events"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:o.totalEvents})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(d,{to:"/admin/events",className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"View all events →"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-500 mr-4",children:e.jsx(c,{className:"text-2xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Upcoming Events"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:o.upcomingEvents})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(d,{to:"/admin/events",className:"text-green-500 hover:text-green-600 text-sm font-medium",children:"Manage events →"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-500 mr-4",children:e.jsx(b,{className:"text-2xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Donations"}),e.jsxs("h3",{className:"text-2xl font-bold text-gray-800",children:["₹",o.totalDonations.toLocaleString()]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(d,{to:"/admin/donations",className:"text-blue-500 hover:text-blue-600 text-sm font-medium",children:"View donations →"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-500 mr-4",children:e.jsx(P,{className:"text-2xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Total Users"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:o.totalUsers})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("span",{className:"text-purple-500 text-sm font-medium",children:"Registered users"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Upcoming Events"}),e.jsx(d,{to:"/admin/events",className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"View All"})]}),h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsxs("div",{className:"flex items-center p-3 border border-gray-100 rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"p-2 rounded-md bg-orange-100 text-orange-500 mr-4",children:e.jsx(c,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-gray-800 font-medium",children:s.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:u(s.date)})]}),e.jsx(d,{to:`/admin/events?edit=${s.id}`,className:"text-blue-500 hover:text-blue-600 text-sm",children:"Edit"})]},s.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No upcoming events scheduled"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Recent Donations"}),e.jsx(d,{to:"/admin/donations",className:"text-orange-500 hover:text-orange-600 text-sm font-medium",children:"View All"})]}),x.length>0?e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs("div",{className:"flex items-center p-3 border border-gray-100 rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"p-2 rounded-md bg-green-100 text-green-500 mr-4",children:e.jsx(b,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"text-gray-800 font-medium",children:s.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:u(s.timestamp)})]}),e.jsxs("div",{className:"text-green-600 font-semibold",children:["₹",s.amount.toLocaleString()]})]},s.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No donations received yet"})]})]})]})]})})};export{$ as default};
