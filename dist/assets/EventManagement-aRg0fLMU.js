import{e as d,j as e,f as q,h as O,i as T,F as z,k as B,m as W,a as _}from"./index-Bu705Vw5.js";import{r}from"./vendor-Cc1FqKl_.js";import"./ui-SGFWqzYs.js";const c="http://localhost:5000/api/events",K=()=>{const[b,I]=r.useState([]),[M,y]=r.useState(!0),[U,j]=r.useState(!1),[o,f]=r.useState(!1),[N,v]=r.useState(null),[t,m]=r.useState({name:"",description:"",date:"",time:"",location:"",price:"",capacity:"",image:""}),[w,n]=r.useState(""),[x,E]=r.useState(null),[C,p]=r.useState(""),[k,g]=r.useState(!1);r.useEffect(()=>{u()},[]);const u=async()=>{try{const a=await d.get(c);I(a.data),y(!1)}catch(a){console.error("Error fetching events:",a),y(!1)}},l=a=>{const{name:s,value:i}=a.target;m(h=>({...h,[s]:i}))},P=a=>{const s=a.target.files[0];if(s){E(s);const i=new FileReader;i.onload=h=>{p(h.target.result)},i.readAsDataURL(s)}},A=async()=>{if(!x)return null;g(!0);const a=new FormData;a.append("image",x);try{return(await d.post(`${c}/upload-image`,a,{headers:{"Content-Type":"multipart/form-data"}})).data.imageUrl}catch(s){throw console.error("Error uploading image:",s),new Error("Failed to upload image")}finally{g(!1)}},F=()=>{m({name:"",description:"",date:"",time:"",location:"",price:"",capacity:"",image:""}),n(""),f(!1),v(null),E(null),p(""),g(!1)},S=(a=null)=>{if(F(),a){f(!0),v(a.id);const s=a.date instanceof Date?a.date.toISOString().split("T")[0]:"";m({name:a.name||"",description:a.description||"",date:s,time:a.time||"",location:a.location||"",price:a.price||"",capacity:a.capacity||"",image:a.image||""}),a.image&&p(a.image.startsWith("http")?a.image:`http://localhost:5000${a.image}`)}j(!0)},D=()=>{j(!1),F()},L=async a=>{if(a.preventDefault(),n(""),!t.name?.trim()){n("Event name is required");return}if(!t.date){n("Event date is required");return}if(!t.location?.trim()){n("Event location is required");return}try{let s=t.image;x&&(s=await A());const i={...t,name:t.name.trim(),description:t.description?.trim()||"",location:t.location.trim(),date:new Date(t.date),price:Number(t.price)||0,capacity:Number(t.capacity)||0,image:s};o&&N?await d.put(`${c}/${N}`,i):await d.post(c,i),D(),u()}catch(s){console.error("Error saving event:",s);const i=s.response?.data?.message||s.message||"Failed to save event. Please try again.";n(i)}},R=async a=>{if(window.confirm("Are you sure you want to delete this event?"))try{await d.delete(`${c}/${a}`),u()}catch(s){console.error("Error deleting event:",s)}},$=a=>a instanceof Date?a.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Invalid date";return M?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-xl",children:"Loading events..."})})}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Event Management"}),e.jsxs("button",{onClick:()=>S(),className:"bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-md flex items-center",children:[e.jsx(q,{className:"mr-2"})," Add New Event"]})]}),b.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:e.jsx("p",{className:"text-gray-500",children:"No events found. Create your first event!"})}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:b.map(a=>e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:a.name}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>S(a),className:"text-blue-500 hover:text-blue-700",children:e.jsx(O,{size:18})}),e.jsx("button",{onClick:()=>R(a.id),className:"text-red-500 hover:text-red-700",children:e.jsx(T,{size:18})})]})]}),e.jsx("p",{className:"text-gray-600 mb-4",children:a.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(z,{className:"mr-2 text-orange-500"}),$(a.date)]}),a.time&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(B,{className:"mr-2 text-orange-500"}),a.time]}),a.location&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(W,{className:"mr-2 text-orange-500"}),a.location]}),a.price>0&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(_,{className:"mr-2 text-orange-500"}),a.price]})]})]})},a.id))}),U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg w-full max-w-2xl mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:o?"Edit Event":"Add New Event"}),w&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:w}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Event Name *"}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Date *"}),e.jsx("input",{type:"date",name:"date",value:t.date,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Time"}),e.jsx("input",{type:"time",name:"time",value:t.time,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:t.location,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Price (â‚¹)"}),e.jsx("input",{type:"number",name:"price",value:t.price,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Capacity"}),e.jsx("input",{type:"number",name:"capacity",value:t.capacity,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2",min:"0"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2",rows:"4"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Event Image"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:P,className:"w-full border border-gray-300 rounded-md px-3 py-2"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Upload an image from your device (max 5MB)"})]}),C&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Preview:"}),e.jsx("img",{src:C,alt:"Preview",className:"w-32 h-32 object-cover rounded-md border"})]}),e.jsxs("div",{className:"border-t pt-3",children:[e.jsx("label",{className:"block text-gray-700 mb-2",children:"Or enter image URL:"}),e.jsx("input",{type:"text",name:"image",value:t.image,onChange:l,className:"w-full border border-gray-300 rounded-md px-3 py-2",placeholder:"https://example.com/image.jpg"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:k,className:"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 disabled:bg-gray-400 disabled:cursor-not-allowed",children:k?"Uploading...":o?"Update Event":"Create Event"})]})]})]})})})]})};export{K as default};
